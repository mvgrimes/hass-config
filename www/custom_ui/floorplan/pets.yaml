page_id: Pets
image: /local/custom_ui/floorplan/pets.svg
stylesheet: /local/custom_ui/floorplan/pets.css
warnings:

variables:
  - name: floorplan.hours
  - name: floorplan.minutes

defaults:
  hover_over: true
  more_info: true

rules:
  # - element: floorplan.clock_button
  #   action:
  #     service: floorplan.page_navigate
  #     data:
  #       page_id: clock_config

  - entities:
      - sensor.dogfed_time
    class_template: '
      if( entity.state > (Date.now() / 1000) - (6*60*60) ) {
        return "chore-done";
      } else {
        return "chore-waiting";
      }
    '
    action:
      service: mqtt.publish
      data:
        topic: "pets/dogfed"
        payload_template: "{{ as_timestamp(now()) }}"

  - entities:
      - sensor.catfed_time
    class_template: '
      if( entity.state > (Date.now() / 1000) - (6*60*60) ) {
        return "chore-done";
      } else {
        return "chore-waiting";
      }
    '
    action:
      service: mqtt.publish
      data:
        topic: "pets/catfed"
        payload_template: "{{ as_timestamp(now()) }}"

  - entities:
      - sensor.dogwalked_time
    class_template: '
      if( entity.state > (Date.now() / 1000) - (6*60*60) ) {
        return "chore-done";
      } else {
        return "chore-waiting";
      }
    '
    action:
      service: mqtt.publish
      data:
        topic: "pets/dogwalked"
        payload_template: "{{ as_timestamp(now()) }}"
