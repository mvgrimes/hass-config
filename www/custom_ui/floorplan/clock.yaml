page_id: Clock
image: /local/custom_ui/floorplan/clock.svg
stylesheet: /local/custom_ui/floorplan/clock.css
warnings:

variables:
  - name: floorplan.hours
  - name: floorplan.minutes

defaults:
  hover_over: false
  more_info: false

rules:
  # - element: floorplan.clock_button
  #   action:
  #     service: floorplan.page_navigate
  #     data:
  #       page_id: clock_config

  - entities:
      - input_datetime.alarm_time
    text_template: '${entity.state ? entity.state.slice(0, 5) : "00:00"}'

  - entities:
      - input_boolean.clock_snooze
    text_template: '${(entity.state === "on") ? "Zzzzzz" : "Snooze"}'
    action:
      service: input_boolean.toggle
      data:
        entity_id: input_boolean.clock_snooze

  - entities:
      - input_boolean.alarm_mode
    text_template: '${(entity.state === "on") ? "Active" : "Inactive"}'
    action:
      service: input_boolean.toggle
      data:
        entity_id: input_boolean.alarm_mode

  - entities:
      - media_player.alarm_clock
    text_template: '${(entity.state === "playing") ? "Stop" : "Radio"}'
    action:
      service_template: '${(entity.state === "playing") ? "media_player.media_stop" : "media_player.play_media"}'
      data:
        media_content_id: "https://playerservices.streamtheworld.com/api/livestream-redirect/WYPR_HD1.mp3"
        media_content_type: audio/mp4
        entity_id: media_player.alarm_clock

  - name: thermostats_temp
    entities:
      - sensor.mbr_temp
      - sensor.kitchen_thermostat_temp
    text_template: '${entity.state ? Math.ceil(entity.state) + "°": "undefined"}'
    class_template: 'return "static-temp";'

  - name: temp_darksky
    entities:
      - sensor.dark_sky_temperature
    text_template: '${entity.state ? Math.ceil(entity.state) + "°": "undefined"}'
    class_template: 'return "static-temp";'

  - name: text_states
    entities:
      - sensor.pws_weather_1d
    hover_over: false
    # more_info: false
    text_template: '${entity.state ? entity.state : "undefined"}'
    # class_template: 'return "static-text";'

  - name: text_carpool_week
    entities:
      - input_boolean.carpool_week
    element: input_boolean.carpool_week
    more_info: false
    text_template: '${(entity.state === "on") ? "G" : "B"}'
    action:
      service: input_boolean.toggle
      data:
        entity_id: input_boolean.carpool_week

  - name: text_carpool_today
    entities:
      - sensor.clock_day
    element: sensor.carpool_today
    more_info: false
    text_template: '
      var driver;
      var day = entity.state ? entity.state : "";

      switch (day) {
        case "Monday":
        case "Wednesday":
          driver = "Grimes";
          break;

        case "Tuesday":
        case "Thursday":
          driver = "Brianas";
          break;

        case "Friday":
          driver = entities["input_boolean.carpool_week"].state === "on" ? "Grimes" : "Brianas";
          break;

        default:
          driver = "--";
      }

      return driver;
      '

  - name: text_carpool_tomorrow
    entities:
      - sensor.clock_day
    element: sensor.carpool_tomorrow
    more_info: false
    text_template: '
      var driver;
      var day = entity.state ? entity.state : "";

      switch (day) {
        case "Sunday":
        case "Tuesday":
          driver = "Grimes";
          break;

        case "Monday":
        case "Wednesday":
          driver = "Brianas";
          break;

        case "Thursday":
          driver = entities["input_boolean.carpool_week"].state === "on" ? "Grimes" : "Brianas";
          break;

        default:
          driver = "--";
      }

      return driver;
      '

  - name: text_font_date
    entities:
      - sensor.clock_date
      - sensor.clock_day
    hover_over: false
    more_info: false
    text_template: '${entity.state ? entity.state : "undefined"}'
    class_template: 'return "static-text-date";'

  - name: text_font_time
    entities:
      - sensor.clock_time
    hover_over: false
    more_info: false
    text_template: '${entity.state ? entity.state : "undefined"}'
    class_template: 'return "static-text-time";'

  - name: text_font_am_pm
    entities:
      - sensor.clock_am_pm
    hover_over: false
    more_info: false
    text_template: '${entity.state ? entity.state : "undefined"}'
    class_template: 'return "static-text-am_pm";'

  # - name: Presence
  #   entities:
  #     - binary_sensor.sleepnumber_carlo_carlo_is_in_bed
  #     - binary_sensor.sleepnumber_carlo_stacey_is_in_bed
  #   states:
  #     - state: 'on'
  #       class: 'presence-on'
  #     - state: 'off'
  #       class: 'presence-off'

  - name: Dark Sky Sensors
    entities:
      - sensor.dark_sky_minutely_summary
    element: sensor.dark_sky_minutely_summary_icon

    image_template: '
      var imageName = "";

      switch (entity.attributes.entity_picture) {
        case "/static/images/darksky/weather-sunny.svg":
          imageName = "sunny-1";
          break;

        case "/static/images/darksky/weather-night.svg":
          imageName = "night-1";
          break;

        case "/static/images/darksky/weather-partlycloudy.svg":
          imageName = "partlycloudy-day-1";
          break;

        case "/static/images/darksky/weather-cloudy.svg":
          imageName = "partlycloudy-night-1";
          break;

        case "/static/images/darksky/weather-cloudy.svg":
          imageName = "cloudy-day-1";
          break;

        case "/static/images/darksky/weather-pouring.svg":
          imageName = "thunder";
          break;

        case "/static/images/darksky/weather-snowy.svg":
          imageName = "snowy-day-1";
          break;
      }

      return "/local/custom_ui/floorplan/images/weather/" + imageName + ".svg";
      '

  # - name: Camera Images
  #   entities:
  #     - camera.stone_door
  #   image_template: '${entity.attributes.entity_picture}'
